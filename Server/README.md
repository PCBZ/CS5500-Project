# User Management System - Server Side

This is the backend server component of the BC Cancer Donor Management System, built with Node.js, Express, and Prisma ORM.

## Prerequisites

- Node.js >= 14.0.0
- MySQL = 8.0
- npm >= 6.0.0

## Installation

1. Clone the repository and navigate to the server directory:
```bash
git clone git@github.com:J3rrrrry/CS5500-Project.git
cd Server
```

2. Install dependencies:
```bash
npm install
```

3. Environment Setup:
   - Copy the environment template file:
   ```bash
   cp .env.example .env
   ```
   - Configure the following variables in `.env`:
   ```env
   # Database Configuration
   DATABASE_URL="mysql://username:password@localhost:3306/your_database"
   
   # JWT Configuration
   JWT_SECRET="your_jwt_secret_key"
   
   # Server Configuration
   PORT=3000
   ```

4. Database Migration:
```bash
npx prisma migrate dev
```

## Running the Server

### Development Environment
```bash
npm run dev
```

### Production Environment
```bash
npm start
```

## API Documentation

Generate API documentation:
```bash
npm run docs
```
The generated documentation will be saved in the `docs` directory and can be viewed by opening `docs/index.html` in a browser.

## Testing

Run tests:
```bash
npm test
```

## Project Structure

```
Server/
├── src/                # Source code
│   ├── routes/        # Route handlers
│   ├── middleware/    # Middleware
│   ├── lib/          # Utilities
│   └── index.js      # Application entry
├── prisma/           # Prisma config & migrations
├── test/            # Test files
├── docs/            # API documentation
└── package.json     # Project configuration
```

## API Endpoints

### User Management API

- POST `/api/user/register` - Register new user
- POST `/api/user/login` - User login
- GET `/api/user/:id` - Get user details
- POST `/api/user/logout` - User logout

Detailed API documentation can be generated by running `npm run docs`.

## Error Handling

The server uses standard HTTP status codes:

- 200: Success
- 201: Created
- 400: Bad Request
- 401: Unauthorized
- 404: Not Found
- 500: Server Error

## Security Features

- Password encryption using bcrypt
- JWT-based authentication
- Request parameter validation
- Error logging

## Development Guidelines

1. Code Style
   - Use ES6+ syntax
   - Use async/await for asynchronous operations
   - Follow RESTful API design principles

2. Before Committing:
   - Run tests `npm test`
   - Update documentation `npm run docs`
   - Ensure no linting errors

## Deployment

1. Prepare Server Environment:
```bash
# Install Node.js and npm
curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash -
sudo apt-get install -y nodejs

# Install MySQL
sudo apt-get install mysql-server
```

2. Database Setup:
```bash
# Create database and user
mysql -u root -p
CREATE DATABASE your_database;
CREATE USER 'your_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON your_database.* TO 'your_user'@'localhost';
FLUSH PRIVILEGES;
```

3. Deploy Application:
```bash
# Clone code
git clone <repository-url>
cd Server

# Install dependencies
npm install

# Configure environment
cp .env.example .env
nano .env

# Run database migrations
npx prisma migrate deploy

# Start server
npm start
```

## Troubleshooting

Common Issues:

1. Database Connection Errors
   - Check database credentials
   - Ensure database service is running
   - Verify firewall settings

2. JWT Authentication Issues
   - Check JWT_SECRET configuration
   - Verify token format
   - Confirm token hasn't expired

3. Prisma Issues
   - Run `npx prisma generate`
   - Ensure schema is up to date

## Contributing

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Create a Pull Request

## License

[MIT License](LICENSE) 